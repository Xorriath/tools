## PoC for CVE-2025-47781

CVE-2025-47781 is a broken authentication vulnerability impacting outaded versions of the Rallly open source CMS web application. Instead of password based authentication, the application features token based authentication. Upon initiating a login request, a 6 digit token is sent to the email associated with the account, which is valid for 15 minutes. As the token itself provides low entropy combined with lack of brute force protection mechanisms(rate limitting, black listing etc.) and long validity time makes it possible to systematically brute force all 6 digit combinations to take over any user account, with the only requirement being knowledge of a user email. It is recommended to update the Rallly instance as per the developer's instructions to avoid this vulnerability.

This script automates exploitation of CVE-2025-47781, by grabbing necessary cookies automatically, building the token wordlist, triggering the login attempt, then finally bruteforce the login token with ffuf and print the authenticated cookie.
Requires ffuf tool to be installed.

## Example
```
./CVE-2025-47781.py -u http://example.com:80 -e user@example.com
```

If succesful, the script will stop ffuf execution and print out the authenticated cookie(next-auth.session-token). Its value can then be copied and replace the unauthenticated next-auth.session-token value to authenticate as the targer user, using the developer tools or the Cookie Editor extension.

In some cases when the value of the generated token is high (ex: 976543) combined with a slow Rallly instance can result in failing to bruteforce the token within the 15 minute limit, but launching the script multiple times would eventually generate a low number token(ex: 234567) and successfully take over the user account even on slow instances of Rallly or less then ideal network conditions.

## Disclaimer
This code is provided for educational and research purposes only. Unauthorized use of this code to access or interfere with systems without explicit permission is illegal and unethical. The authors take no responsibility for any misuse or damage caused by this code. Always obtain proper authorization before testing any system or application.
